
# Dockerを使わない場合の最低限のルール
（将来Dockerに移行しやすい設計／技術者同士で揉めない説明テンプレ含む）

---

## 1. Dockerを使わない場合の「最低限のルール」

### 1-1. Node.js のバージョンを固定する【最重要】
- `.nvmrc` または `.node-version` を必ず置く
- ファイルには Node.js の正確なバージョンを1行で記載
- README にも同じ内容を書く

目的：
- 開発者ごとの差異を防ぐ
- 将来Docker化したときにベースイメージを即決できる

---

### 1-2. パッケージ管理は lock ファイル必須
- `package-lock.json` / `yarn.lock` を必ず Git 管理
- 手動編集禁止
- lock ファイルがないPRはマージしない

---

### 1-3. npm / yarn の種類を統一する
- プロジェクトごとにどちらか一方のみ
- 混在は禁止
- npmを使っているなら npm で問題なし

---

### 1-4. 環境変数はファイルで管理する
- `.env` は使ってOK
- `.env` は Git に入れない
- `.env.example` を必ず Git に入れる
- 必要なキーを全て列挙する（値は空でOK）

---

### 1-5. OS依存コードを書かない
- パス操作は `path.join`
- ファイル操作は Node.js 標準API
- Windows / Linux 前提コードは禁止

---

### 1-6. シェルコマンド直書き禁止
以下は原則禁止：
- `rm -rf`
- `del`
- `grep / sed / awk`
- OS依存の shell script

代替：
- Node.js の `fs`, `path`
- クロスプラットフォーム対応ライブラリ

---

### 1-7. 起動方法を1つに統一する
- 起動は `npm run start`
- ビルドは `npm run build`
- 個人独自コマンド禁止

---

### 1-8. 開発・検証・本番の動かし方を揃える
- 手動起動禁止
- 必ずスクリプト経由

---

### 1-9. READMEに最低限書くこと
- Node.js バージョン
- npm/yarn の種類
- 起動方法
- 環境変数の説明

---

### 1-10. 本番サーバーを直接触らない
- 修正は Git 経由のみ
- SSHで直接修正禁止

---

## 2. 将来Dockerに移行しやすい設計

### 2-1. 設定値はすべて環境変数へ
- DB接続情報
- ポート番号
- 秘密情報

理由：
- Docker / docker-compose にそのまま移行できる

---

### 2-2. 1コマンド起動を前提にする
- Dockerfileはこのコマンドを呼ぶだけにできる
- 手順書が不要になる

---

### 2-3. ローカルディスク依存を避ける
- ファイルは外部ストレージ or DB
- ログは標準出力

---

### 2-4. ネットワーク越しのDB接続を前提にする
- `localhost` 固定禁止
- 必ず `DB_HOST` を使う

---

### 2-5. OS非依存を徹底する
- 将来Linuxコンテナにそのまま移行可能

---

## 3. 技術者同士で揉めない説明テンプレ

### テンプレ① 基本形
Dockerのメリット（環境統一・再現性）は理解しています。  
一方で現時点では運用コスト（学習、監査、手順整備）が増えるため、  
まずは Nodeバージョン固定・lock運用・起動手順統一 をルール化します。  
それでも問題が出た段階でDocker導入を検討します。

---

### テンプレ② 将来を否定しない形
Docker導入は将来の選択肢として否定しません。  
ただし今の課題がDockerでしか解決できないかを先に整理したいです。  
具体的な問題が出た段階で導入判断を行いましょう。

---

### テンプレ③ 大企業向け（監査・ライセンス）
大企業ではDocker Desktopのライセンスや監査対応が論点になります。  
導入する場合はLinuxサーバー集約型が前提となるため、  
現時点ではルール整備を優先し、必要になった段階で正式検討したいです。

---

## まとめ
- Dockerは保険
- まずは運用ルール
- 回らなくなったらDocker
